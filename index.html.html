<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Trixia GWA Calculator</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

<style>
:root {
  --bg: linear-gradient(135deg, #ffd6e0, #ffe0f0);
  --card-bg: rgba(255, 240, 245, 0.7);
  --primary: #d6336c;
  --secondary: rgba(255, 182, 193, 0.5); 
  --text: #3f1d2b;
  --muted: #a3667f;
  --toggle-off: #f3d4e0;
  --toggle-on: #f472b6;
  --icon-active: #ffb6c1; 
  --icon-inactive: #f3d4e0;
  --btn-hover: #c0266f;
}

body.dark {
  --bg: linear-gradient(135deg, #3a0e28, #5b1a3d);
  --card-bg: rgba(91, 26, 61, 0.85);
  --text: #ffe6f0;
  --muted: #f7c6d9;
  --secondary: rgba(199, 97, 144, 0.6);
  --toggle-off: #62254f;
  --toggle-on: #ff6fa3;
  --icon-active: #ffb6c1; 
  --icon-inactive: #f3d4e0;
  --btn-hover: #ff4d94;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  background: var(--bg);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  color: var(--text);
  font-family: 'Roboto', sans-serif;
  transition: background .3s, color .3s;
}

.container {
  width: 100%;
  max-width: 440px;
  background: var(--card-bg);
  border-radius: 20px;
  padding: 5% 4%;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  box-shadow: 0 8px 32px rgba(0,0,0,0.12);
  transition: background .3s, color .3s;
  position: relative;
}

.top-bar { display: flex; justify-content: flex-end; margin-bottom: 16px; }
.switch { position: relative; display: inline-block; width: 52px; height: 28px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: relative; display: flex; align-items: center; justify-content: space-between; background-color: var(--toggle-off); border-radius: 50px; cursor: pointer; transition: background .3s; padding: 0 6px; height: 100%; font-size: 14px; }
.slider .icon-sun, .slider .icon-moon { pointer-events: none; transition: color .3s; }
.icon-sun { color: var(--icon-active); }
.icon-moon { color: var(--icon-inactive); }
input:checked + .slider .icon-sun { color: var(--icon-inactive); }
input:checked + .slider .icon-moon { color: var(--icon-active); }
.slider:before { content: ""; position: absolute; top: 4px; left: 4px; width: 20px; height: 20px; background-color: white; border-radius: 50%; transition: transform .3s, background .3s; }
input:checked + .slider:before { transform: translateX(24px); }

.top-icon { display: flex; justify-content: center; margin-top: 8px; margin-bottom: 16px; }
.top-icon img { width: 25%; max-width: 90px; height: auto; object-fit: contain; border-radius: 50%; box-shadow: 0 4px 15px rgba(255, 105, 180, 0.5); transition: transform 0.3s, box-shadow 0.3s; }
.top-icon img:hover { transform: scale(1.1); box-shadow: 0 6px 20px rgba(255, 105, 180, 0.7); }

h1 { margin: 0 0 8px; text-align: center; color: var(--primary); font-size: 2rem; font-family: 'Poppins', sans-serif; font-weight: 700; }
.subtitle { text-align: center; font-size: 1rem; color: var(--muted); margin-bottom: 16px; }

.subject { display: grid; grid-template-columns: 1fr 0.8fr auto; gap: 12px; margin-bottom: 12px; background: var(--secondary); padding: 14px; border-radius: 14px; backdrop-filter: blur(8px); transition: transform .3s, box-shadow .3s, background .3s; }
.subject:hover { transform: translateY(-3px); box-shadow: 0 12px 24px rgba(0,0,0,0.15); background: rgba(255,192,203,0.65); }
.subject input[type="number"] { width: 100%; padding: 10px 12px; border-radius: 10px; border: none; font-size: 0.9rem; font-family: 'Roboto', sans-serif; transition: background .3s, color .3s, box-shadow .3s; }
.subject input[type="number"]:nth-child(1) { background: rgba(255,182,193,0.7); color: var(--text); }
.subject input[type="number"]:nth-child(2) { background: rgba(255,192,203,0.7); color: var(--text); }

body.dark .subject { background: rgba(255, 105, 180, 0.2); backdrop-filter: blur(12px); box-shadow: 0 0 12px rgba(255,105,180,0.5), 0 4px 20px rgba(0,0,0,0.25); border: 1px solid rgba(255, 105, 180, 0.4); }
body.dark .subject input[type="number"] { background: rgba(255, 105, 180, 0.25); color: #fff; border-radius: 12px; border: 1px solid rgba(255, 182, 193, 0.4); font-size: 0.9rem; padding: 10px 12px; }

.midterm input[type="number"] {
  background: rgba(255,182,193,0.7);
  color: var(--text);
  border-radius: 14px;
  width: 100%;
  border: none;
  font-size: 0.9rem;
  padding: 10px 12px;
  text-align: center;
  transition: background .3s, color .3s, border .3s;
}
body.dark .midterm input[type="number"] {
  background: rgba(255, 105, 180, 0.25);
  color: #fff;
  border-radius: 12px;
  border: 1px solid rgba(255, 182, 193, 0.4);
}

button { border: none; border-radius: 10px; padding: 12px; font-size: 1rem; font-weight: 500; cursor: pointer; transition: background .3s, color .3s, transform .2s; font-family: 'Poppins', sans-serif; }
.remove { background: rgba(255,105,180,0.2); color: #db2777; }
body.dark .remove { background: rgba(255,105,180,0.2); color: #ff99c2; }
.add { width: 100%; background: linear-gradient(135deg, #ff7eb9, #ff49a0); margin-top: 12px; font-weight: 600; color: #fff; }
body.dark .add { background: linear-gradient(135deg, #ff69b4, #db2777); color: #fff; }
.add:hover { transform: scale(1.05); }
.calculate { width: 100%; background: linear-gradient(135deg, #d6336c, #e11d48); color: #fff; margin-top: 14px; font-weight: 700; }
.calculate:hover { transform: scale(1.05); }
.result { margin-top: 18px; text-align: center; font-size: 1.3rem; font-weight: 600; color: #d6336c; transition: color .3s; }
footer { margin-top: 24px; text-align: center; font-size: 0.8rem; color: var(--muted); }

.modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); font-family: 'Poppins', sans-serif; }
.modal-content { background: linear-gradient(135deg, #ffb6c1, #ff69b4); margin: 15% auto; padding: 30px; border-radius: 16px; width: 80%; max-width: 360px; text-align: center; color: #fff; box-shadow: 0 8px 30px rgba(0,0,0,0.25); position: relative; overflow: hidden; }
.modal-content h2 { margin-top: 0; font-size: 1.6rem; }
.modal-content p { font-size: 1.1rem; margin: 12px 0 0; }
.close-btn { margin-top: 20px; padding: 10px 20px; background: #fff; color: #ff69b4; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; transition: transform 0.2s; }
.close-btn:hover { transform: scale(1.05); }

@media (max-width: 480px) {
  .container { padding: 6% 3%; border-radius: 16px; }
  h1 { font-size: 1.6rem; }
  .subtitle { font-size: 0.9rem; margin-bottom: 18px; }
  .top-icon img { width: 40%; max-width: 70px; }
  .subject { grid-template-columns: 1fr 0.9fr auto; gap: 10px; padding: 10px; }
  .subject input[type="number"] { font-size: 0.85rem; padding: 8px 10px; }
  button { font-size: 0.9rem; padding: 10px; }
  .add, .calculate { width: 100%; }
  .modal-content { width: 90%; padding: 20px; }
  .modal-content h2 { font-size: 1.4rem; }
  .modal-content p { font-size: 1rem; }
}
</style>
</head>
<body>

<div class="container">
  <div class="top-bar">
    <label class="switch">
      <input type="checkbox" id="themeToggle">
      <span class="slider">
        <span class="icon-sun">‚òÄ</span>
        <span class="icon-moon">üåô</span>
      </span>
    </label>
  </div>

  <h1>Trixia GWA Calculator</h1>
  <div class="subtitle">Developed by Yuan</div>

  <div class="top-icon">
    <img src="/hellokitty.png" alt="Hello Kitty" />
  </div>

  <!-- Midterm GWA input -->
  <div class="subject midterm" style="grid-template-columns: 1fr; justify-items: center; margin-bottom: 20px;">
    <input type="number" step="0.0001" min="1" max="5" id="midtermGWA" placeholder="Enter Midterm GWA">
  </div>

  <!-- Subjects container with one default input -->
  <div id="subjects">
    <div class="subject">
      <input type="number" step="0.0001" min="1" max="5" placeholder="Final Grade">
      <input type="number" step="0.0001" min="1" max="5" placeholder="Units">
      <button class="remove" onclick="removeSubject(this)">‚ùå</button>
    </div>
  </div>

  <button class="add" onclick="addSubject()">‚ûï Add Subject</button>
  <button class="calculate" onclick="calculateGWA()">üìä Calculate GWA</button>

  <div id="result" class="result"></div>

  <footer>Tarlac State University ‚Ä¢ 2025</footer>
</div>

<div id="gwaModal" class="modal">
  <div class="modal-content" id="modalContent">
    <h2 id="modalTitle"></h2>
    <p id="modalMessage"></p>
    <button class="close-btn" onclick="closeModal()">Close</button>
  </div>
</div>

<canvas id="confetti-canvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1000;"></canvas>

<script>
const subjectsContainer = document.getElementById('subjects');
const themeToggle = document.getElementById('themeToggle');
const modal = document.getElementById('gwaModal');
const modalTitle = document.getElementById('modalTitle');
const modalMessage = document.getElementById('modalMessage');
const confettiCanvas = document.getElementById('confetti-canvas');
const ctx = confettiCanvas.getContext('2d');

themeToggle.addEventListener('change', () => {
  document.body.classList.toggle('dark', themeToggle.checked);
});

function addSubject() {
  const div = document.createElement('div');
  div.className = 'subject';
  div.innerHTML = `
    <input type="number" step="0.0001" min="1" max="5" placeholder="Grade">
    <input type="number" step="0.0001" min="1" max="5" placeholder="Units">
    <button class="remove" onclick="removeSubject(this)">‚ùå</button>
  `;
  subjectsContainer.appendChild(div);
}

function removeSubject(btn) {
  btn.parentElement.remove();
}

function calculateGWA() {
  const midtermInput = document.getElementById('midtermGWA');
  const midterm = parseFloat(midtermInput.value);

  if (!midterm) {
    showModalError("Please enter your Midterm GWA before calculating.");
    return;
  }

  const subjectDivs = subjectsContainer.querySelectorAll('.subject');
  let totalUnits = 0;
  let totalPoints = 0;
  let emptyFound = false;

  subjectDivs.forEach(sub => {
    const inputs = sub.querySelectorAll('input');
    const grade = parseFloat(inputs[0].value);
    const units = parseFloat(inputs[1].value);

    if (!grade || !units) emptyFound = true;

    totalUnits += units || 0;
    totalPoints += (grade || 0) * (units || 0);
  });

  if (emptyFound) {
    showModalError("Please fill in all Final Grade and Units fields.");
    return;
  }

  let midtermWeighted = midterm * 0.5;
  let finalWeighted = totalUnits > 0 ? (totalPoints / totalUnits) * 0.5 : 0;

  let gwa = midtermWeighted + finalWeighted;
  gwa = parseFloat(gwa.toFixed(4)); 

  showModalResult(gwa);
}

function showModalResult(gwa) {
  modal.style.display = 'block';
  const gwaText = gwa.toFixed(4);
  let message = "";

  if (gwa <= 1.75) {
    message = `üéâ Congratulations! You made the Dean's List! Your GWA is: <span style="color:#ffeb3b; font-weight:700;">${gwaText}</span>`;
    startConfetti();
  } else if (gwa <= 2.0) {
    message = `Good job! You are close to the Dean's List. Your GWA is: <span style="color:#ff9800; font-weight:700;">${gwaText}</span>`;
  } else {
    message = `Keep pushing! Your GWA is: <span style="color:#f44336; font-weight:700;">${gwaText}</span>`;
  }

  modalMessage.innerHTML = message; 
}

function showModalError(message) {
  modal.style.display = 'block';
  stopConfetti();
  modalMessage.innerHTML = `‚ö†Ô∏è ${message}`;
}

function closeModal() {
  modal.style.display = 'none';
  stopConfetti();
}

let confettiArray = [];
let animationId;

function startConfetti() {
  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;
  confettiArray = [];
  for(let i=0; i<150; i++){
    confettiArray.push({
      x: Math.random() * confettiCanvas.width,
      y: Math.random() * confettiCanvas.height - confettiCanvas.height,
      r: Math.random() * 6 + 4,
      d: Math.random() * 10 + 5,
      color: `hsl(${Math.random()*360},100%,70%)`,
      tilt: Math.random() * 10 - 10,
      tiltAngleIncrement: Math.random() * 0.07 + 0.05,
      tiltAngle: 0
    });
  }
  animateConfetti();
}

function animateConfetti() {
  ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
  confettiArray.forEach(c => {
    c.tiltAngle += c.tiltAngleIncrement;
    c.y += (Math.cos(c.d) + 3 + c.r/2)/2;
    c.tilt = Math.sin(c.tiltAngle) * 15;
    ctx.beginPath();
    ctx.lineWidth = c.r/2;
    ctx.strokeStyle = c.color;
    ctx.moveTo(c.x + c.tilt + c.r/4, c.y);
    ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r/4);
    ctx.stroke();
  });
  animationId = requestAnimationFrame(animateConfetti);
}

function stopConfetti() {
  cancelAnimationFrame(animationId);
  ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
}
</script>

</body>
</html>
